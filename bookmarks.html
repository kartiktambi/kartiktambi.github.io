<!DOCTYPE html>
<html>
<head>
  <title>Export Bookmarks</title>
  <style>
   #response-label {
      width: 90%;
      max-width: 520px;
      height: auto;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
    }

    .value-group {
      width: 90%;
      max-width: 520px;
      border: 2px solid #007aff;
      border-radius: 10px;
      padding: 10px;
      margin-bottom: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .value-group p {
      margin: 0;
      font-size: 14px;
    }

    .value-group p.col2 {
      font-weight: bold;
      font-size: 16px;
    }

    .value-group a {
      color: #007aff;
      text-decoration: none;
    }

    .value-group img {
      width: 90%;
      max-width: 100%;
      height: auto;
      border-radius: 10px;
      box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.5);
    }
  </style>
  <script>
    function doubleDecodeNumber(doubleEncodedNumber) {
      const base64Decoded = atob(doubleEncodedNumber);
      const base64DecodedAgain = atob(base64Decoded);
      const dividedNumber = parseFloat(base64DecodedAgain) / 2;
      return dividedNumber;
    }

    function cleanUpResponse(rawResponse) {
      const startIndex = rawResponse.indexOf('google.visualization.Query.setResponse(') + 'google.visualization.Query.setResponse('.length;
      const endIndex = rawResponse.lastIndexOf(');');
      const jsonResponse = rawResponse.substring(startIndex, endIndex);
      return jsonResponse;
    }

    function formatListToText(list) {
      return list.join(' OR ');
    }

    function displayExtractedValues(jsonResponse) {
      const rows = jsonResponse.table.rows;

      let extractedValues = '';

      for (let i = 0; i < rows.length; i++) {
        const row = rows[i];
        const col1 = row.c[0].f;
        const col2 = row.c[1].v;
        const col3 = row.c[2].v;
        const col4 = row.c[3].v;
        const col5 = row.c[4].v;
        const col6 = row.c[5].v;
        const col7 = row.c[6].v;

        let col4Formatted = col4;
        let col5Formatted = col5;
        let col6Formatted = col6;

        if (col4 !== 'NA') {
          col4Formatted = `<a href="${col4}" target="_blank">${col4}</a>`;
        }
        if (col5 !== 'NA') {
          col5Formatted = `<a href="${col5}" target="_blank">${col5}</a>`;
        }
        if (col6 !== 'NA') {
          col6Formatted = `<a href="${col6}" target="_blank">${col6}</a>`;
        }

        extractedValues += `
          <div class="value-group">
            <p class="col2">${col2}</p>
            <p>${col1}</p>
            <img src="${col3}">
            <p>${col7}</p>
            <p>${col4Formatted}</p>
            <p>${col5Formatted}</p>
            <p>${col6Formatted}</p>
          </div>
        `;
      }

      // Display the extracted values in the label
      const responseLabel = document.getElementById('response-label');
      responseLabel.innerHTML = extractedValues;
    }

    function displayExtractedValues(jsonResponse) {
      const rows = jsonResponse.table.rows;

      let extractedValues = '';

      for (let i = 0; i < rows.length; i++) {
        const row = rows[i];
        const col1 = row.c[0].f;
        const col2 = row.c[1].v;
        const col3 = row.c[2].v;
        const col4 = row.c[3].v;
        const col5 = row.c[4].v;
        const col6 = row.c[5].v;
        const col7 = row.c[6].v;

        let col4Formatted = col4;
        let col5Formatted = col5;
        let col6Formatted = col6;

        if (col4 !== 'NA') {
          col4Formatted = `<a href="${col4}" target="_blank">${col4}</a>`;
        }
        if (col5 !== 'NA') {
          col5Formatted = `<a href="${col5}" target="_blank">${col5}</a>`;
        }
        if (col6 !== 'NA') {
          col6Formatted = `<a href="${col6}" target="_blank">${col6}</a>`;
        }

        extractedValues += `
          <div class="value-group">
            <p class="col2">${col2}</p>
            <p>${col1}</p>
            <img src="${col3}">
            <p>${col7}</p>
            <p>${col4Formatted}</p>
            <p>${col5Formatted}</p>
            <p>${col6Formatted}</p>
          </div>
        `;
      }

      // Display the extracted values in the label
      const responseLabel = document.getElementById('response-label');
      responseLabel.innerHTML = extractedValues;
    }
  </script>
</head>
<body onload="getRequest()">
  <div id="response-label">Processing...</div>
</body>
</html>
