<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shree Ramshalaka Prashnavali</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
        }

        #matrix-container, #result-page {
            display: none;
        }

        h1, h2, p {
            margin-bottom: 20px;
        }
        
        h1 {
        	font-size : 35px;
        }

        button {
    	    padding: 20px;
            padding-left: 30px;
            padding-right: 30px;
            margin: 10px;
            font-size: 22px;
            font-weight: bold;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #087809;
            color: #fff;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #27ae60;
        }
        
        table {
            border-collapse: collapse;
            margin: auto;
            border: 5px solid #27ae60;
            width: 100%;
            height: 100%;
        }
        
        td {
            width: 6.6667%;
            height: 6.6667%;
            vertical-align: middle;
            border: 3px solid #3498db;
            cursor: pointer;
            transition: background-color 0.3s;
            font-weight: bold;
            font-size: 10vw;
            color: #ff0000;
        }
        
      	.tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
        }

      	.tab {
            cursor: pointer;
            padding: 10px 20px;
            background-color: #f2f2f2;
            border: 2px dashed #000;
            border-radius: 5px 5px 0 0;
            margin-left:15px;
            font-weight: bold;
			color: black;
        }

        .tab:hover {
            background-color: #ddd;
        }
        .tab.active {
            background-color: #3498db;
            color: white;
	    	border: 2px solid #000;
        }

        .content {
            display: none;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 0 0 5px 5px;
        }

        .content.active {
            display: block;
        }

	    .header {
            background-color: #ffffff;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo img {
            height: 60px;
            width: auto;
        }

        .about-button {
            background-color: #04aa6d;
            color: white;
            padding: 15px 20px;
            margin-right: 15px;
            border: none;
            font-size: 20px;
			font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            font-family: "Arial", sans-serif;
            transition: background-color 0.3s ease;
        }

        .about-button:hover {
            background-color: #038857;
        }

        .about-button:active {
            background-color: #3498db;
        }
    </style>
</head>
<body>


<div id="webheader" class="header" style="display:flex">
	<div class="logo">
		<img src="sitelogo.jpg" alt="Logo">
	</div>
	<a href="https://google.com" class="about-button" target="_blank" rel="noopener noreferrer">About Us</a></div>
</div>

<!-- Welcome Page -->
<div id="welcome-page">
	<h1 style="font-weight:bold; color:red;">Shree Ramshalaka Prashnavali</h1>
	<img src="shriram image.png" width="250px" style="margin-bottom:10px"><br><br>
	
	<div class="tabs">
	<div class="tab active" onclick="showTab('hindi')" data-tab="hindi">हिंदी में देखें</div>
	<div class="tab" onclick="showTab('english')" data-tab="english">View in English</div>
	</div>

  	<div id="hindiContent" class="content active" style="border: 0px solid #000;">
        <div style="text-align: left; width:90%; margin: auto;">
		<p style="font-size: 18px; color:black; font-weight:bold; display:inline; margin-bottom:5px;">श्री रामशलाका प्रश्नावली का यह वेब-ऐप संस्करण प्राचीन ज्ञान को आधुनिक तकनीक के साथ मिलाने का एक विनम्र प्रयास है।</p>
		<p style="font-size: 18px; color:black; font-weight:bold;">यह वेब-ऐप उपयोगकर्ता के फोकस निर्धारण बिंदु की पहचान करने के लिए आई-ट्रैकर कैलिब्रेशन का उपयोग करता है। इस प्रक्रिया में कोई उपयोगकर्ता डेटा रिकॉर्ड नहीं किया जाता है।</p><br>
		<p style="font-size: 20px; text-align: center;  font-weight:bold; color: red;  margin-top:0px;"><u>कृपया नीचे दिए गए निर्देशों को ध्यानपूर्वक पढ़ें -</u></p>
		<p style="font-size: 18px; color:black;">श्री रामशलाका प्रश्नावली संत गोस्वामी तुलसीदास द्वारा रचित 'श्री राम चरित मानस' का एक अंश है। इस प्रश्नावली का उपयोग आपके प्रश्नों के उत्तर पाने या आपके द्वारा किए जाने वाले प्रयासों के परिणाम की भविष्यवाणी करने के लिए किया जाता है।</p>
		<p style="font-size: 18px; color:black;">उत्तर/भविष्यवाणियां 'श्री राम चरित मानस' के चोपाई (दोहे) पर आधारित हैं।</p>
		<p style="font-size: 18px; color:black;">श्री रामशलाका प्रश्नावली 15x15 ग्रिड है। ग्रिड के प्रत्येक वर्ग में श्री राम चरित मानस की नौ चौपाइयों (दोहे) में से एक अक्षर (हिंदी वर्णमाला) है।</p><br>
		
		<p style="font-size: 20px; text-align: center;  font-weight:bold; color: red;  margin-top:0px;"><u>इस वेब-ऐप में श्री रामशलाका प्रश्नावली का उपयोग कैसे करें: -</u></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">१)  </span><span style="color:black; font-weight:normal;">चुपचाप बैठें और मन से कोई भी विचार निकाल लें।</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">२)  </span><span style="color:black; font-weight:normal;">सबसे पहले भगवान श्री राम को प्रणाम करें और अपने प्रश्न पर ध्यान केंद्रित करें।</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">३)  </span><span style="color:black; font-weight:normal;">अपने मन में प्रश्न स्पष्ट शब्दों में पूछें।</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">४)  </span><span style="color:black; font-weight:normal;">स्क्रीन पर "प्रारंभ" बटन दबाएं।</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">५)  </span><span style="color:black; font-weight:normal;">कृपया एक मिनट के लिए मन में "जय श्री राम" का जाप करते हुए स्क्रीन पर नारंगी बिंदु का अनुसरण करें।</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">६)  </span><span style="color:black; font-weight:normal;">उसके बाद, प्रश्नावली ग्रिड दिखाई देगी।</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">७)  </span><span style="color:black; font-weight:normal;">किसी एक अक्षर/ किसी एक वर्ग पर 10 सेकंड तक फोकस करें। केवल एक बार ही ध्यान केंद्रित करें क्योंकि विचलित ध्यान ईश्वर में विश्वास की कमी को दर्शाता है।</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">८)  </span><span style="color:black; font-weight:normal;">जिस वर्ग पर आपने ध्यान केंद्रित किया है, वहां से शुरू करके हर नौवें वर्ग से अक्षर लिए जाते हैं और एक क्रम में जोड़ दिए जाते हैं। यह 'श्री राम लिखित मानस' से एक चौपाई बनती है। पूछे गए प्रश्न का उत्तर इस प्रकार बनी चोपाई पर आधारित है।</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">९)  </span><span style="color:black; font-weight:normal;">यह आपको दूसरे पृष्ठ पर ले जाएगा जहां उत्तर सकारात्मक होने पर हरे रंग में और नकारात्मक होने पर लाल रंग में हाइलाइट किया जाएगा। साथ ही रामायण की चौपाई और उसकी व्याख्या भी बताई जाएगी.</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">१०)  </span><span style="color:black; font-weight:normal;">कृपया केवल गंभीर प्रश्न पूछें और प्रतिदिन एक प्रश्न पूछें।</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">११)  </span><span style="color:black; font-weight:normal;">प्रश्नावली का प्रयोग खेल के रूप में नहीं करना चाहिए।</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">१२)  </span><span style="color:black; font-weight:normal;">व्यक्ति को एक ही प्रश्न बार-बार नहीं पूछना चाहिए। भगवान राम द्वारा दिये गये निर्णय को ही अंतिम मानना ​​चाहिए।</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">१३)  </span><span style="color:black; font-weight:normal;">हम जो भी करेंगे, वही होगा जो भगवान राम ने तय किया है। इसलिए, यदि उत्तर नकारात्मक है, तो ईश्वर जिस ओर इशारा कर रहा है उस पर भरोसा करें।</span></p>
        </div>
		<hr class="dashed" style="width:50%">
		<button onclick="showMatrixPage()">प्रारंभ करें ➤</button>
  	</div>
    
  	<div id="englishContent" class="content" style="border: 0px solid #000;">
	<div style="text-align: left; width:90%; margin: auto;">
		<p style="font-size: 18px; color:black; font-weight:bold; display:inline; margin-bottom:5px;">This web-app version of Shree Ramshalaka Prashnavali is a humble attempt to merge ancient wisdom with modern technology. </p>
		<p style="font-size: 18px; color:black; font-weight:bold;">This web-app uses eye-tracker calibration to identify user's focus fixation point. No user data is recorded in the process.</p><br>
		<p style="font-size: 20px; text-align: center;  font-weight:bold; color: red;  margin-top:0px;"><u>Kindly read below Instructions carefully - </u></p>
		<p style="font-size: 18px; color:black;">Shree Ramshalaka Prashnavali is an extract from 'Shri Ram Charit Manas', authored by the Saint Goswami Tulsidas. This Prashnavali is used to get answers to your questions or predict the outcome of endeavors you want to take. </p>
		<p style="font-size: 18px; color:black;">The answers / predictions are based on Chopais (couplets) from 'Shri Ram Charit Manas'. </p>
		<p style="font-size: 18px; color:black;">Shree Ramshalaka Prashnavali is a 15x15 grid. Each square in the grid has one Akshar (Hindi alphabet) from nine Chopais (couplets) of Shri Ram Charit Manas. </p><br>
            
		<p style="font-size: 20px; text-align: center;  font-weight:bold; color: red;  margin-top:0px;"><u>How to Use Shree Ramshalaka Prashnavali in this web-app :-</u></p>    
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">1)  </span><span style="color:black; font-weight:normal;">Sit silently and clear the mind of any thoughts.</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">2)  </span><span style="color:black; font-weight:normal;">Bow to Lord Shree Ram first and concentrate on your question.</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">3)  </span><span style="color:black; font-weight:normal;">Ask the question in your mind in clear and distinct words.</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">4)  </span><span style="color:black; font-weight:normal;">Press "Begin" button on screen.</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">5)  </span><span style="color:black; font-weight:normal;">Please follow the orange dot on screen with chanting "Jai Shree Ram" in mind, for a minute.</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">6)  </span><span style="color:black; font-weight:normal;">After that, Prashnavali Grid shall be visible.</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">7)  </span><span style="color:black; font-weight:normal;">Focus on any one Akshar/ any one square for 10 seconds. Focus only once as distracted focus shows lack of faith in GOD.</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">8)  </span><span style="color:black; font-weight:normal;">The akshars from every ninth square starting from the square on which you have focused are taken and joined in a sequence. This forms one Chopai from 'Shri Ram Cahrit Manas'. The answer to the question asked is based on the Chopai so formed.</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">9)  </span><span style="color:black; font-weight:normal;">It will take you to another page where the answer will be highlighted in green if it is positive and red if it is negative. Also, the chaupai of the ramayan and the explanation of the same will be explained.</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">10)  </span><span style="color:black; font-weight:normal;">Please ask only serious question and one question a day.</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">11)  </span><span style="color:black; font-weight:normal;">One must not use the Prashnavali as the game.</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">12)  </span><span style="color:black; font-weight:normal;">One must not ask the same questions over and over again. One should take the decision given by Lord Ram as final.</span></p>
		<p style="font-size: 18px; margin:10px;"><span style="color:red; font-weight:bold;">13)  </span><span style="color:black; font-weight:normal;">Whatever we do, the only thing that will happen is what Lord Ram has decided. So, if the answer is negative, trust what God is pointing to.</span></p>
        </div>
		<hr class="dashed" style="width:50%">
		<button onclick="showMatrixPage()">Click to Begin ➤</button>
  	</div>	
</div>

<!-- Matrix Page -->
<div id="matrix-container">
    <table id="matrix">
        <!-- Matrix to be generated dynamically -->
    </table>

	<div id="gaze" style="position: absolute; display:none; width: 80px; height: 80px ;border-radius: 50%;border: solid 2px  rgba(255, 255, 255, .2);	box-shadow: rgba(125, 125, 125, 0.9) 0px 0px 50px 10px; pointer-events: none; z-index: 999999"></div>
    <!--Original Gaze-->
	<!--<div id ="gaze" style ='position: absolute;display:none;width: 100px;height: 100px;border-radius: 50%;border: solid 2px  rgba(255, 255,255, .2);	box-shadow: 0 0 100px 3px rgba(125, 125,125, .5);	pointer-events: none;	z-index: 999999'></div>-->
</div>

<!-- Result Page -->
<div id="result-page">
    <h1 style="font-weight:bold;">Shree Ramshalaka Prashnavali</h1>
    <br><span style="font-size:25px; color:#ff7133; font-weight:bold">• Chosen Letter - <span id="result-value" style="font-size:25px; color:#ff7133; font-weight:bold"></span> •</span><br><br>

    <div style="line-height: 1.5;">
        <span style="font-size:22px; color:black; font-weight:bold; margin-bottom:10px;"><u>उत्तरस्वरुप चौपाई</u> -</span><br>
        <span style="font-size:23px; color:black; display:inline-block; width: 80%"><b><span id="result1"></span></b></span><br><br>
        <!--<img id="result-image" width="50" height="50" style="margin-bottom:10px"><br>-->
        <span class="title" style="font-size:22px; margin-bottom:10px; color:black;"><u>फल</u> -</span><br>
        <span style="font-size:23px; display:inline-block; width: 80%"><b><span id="result2"></span></b></span><br><br>
        <span style="font-size:22px; margin-bottom:10px; color:black;"><u>Answer</u> -</span><br>
        <span style="font-size:23px; display:inline-block; width: 80%"><b><span id="result3"></span></b></span><br>
        <hr class="dashed" style="width:50%">
        <span style="font-size:21px; color:black; font-weight:bold; margin-bottom:5px;"><u>श्रीरामचरितमानस में स्थान</u> -</span><br>
        <span style="font-size:20px; color:black; display:inline-block; width: 80%"><span id="result4"></span></span><br><br>
        <span style="font-size:21px; color:black; font-weight:bold; margin-bottom:5px;"><u>चौपाई</u> -</span><br>
        <span style="font-size:20px; color:black; display:inline-block; width: 80%"><b><span id="result5"></span></b></span><br><br>
        <span style="font-size:21px; color:black; font-weight:bold; margin-bottom:5px;"><u>भावार्थ</u> -</span><br>
        <span style="font-size:20px; color:black; display:inline-block; width: 80%"><span id="result6"></span></span><br><br>
    </div>
    <button onclick="restartGame()" style="margin:15px">Click to Restart</button>
</div>

<script src="alldata.js" ></script>
<script src="GazeCloudAPI.js" ></script>
    
<script>
    var finalx, finaly;
    var totalentries = 0;
    var caldone = 0;
    var eyedata = [];
    var maxDifference = -1;
    var maxX, maxY;
	
    let chosenarray = []; //the random array
	let usagearray = []; //above array to be shuffled
	
    var mX = window.innerWidth - 1; //maximum x of screen
    var mY = window.innerHeight - 1; //maximum y of screen
    var cellwd = mX/3; // max divided by 15, to get width/x of equal cell
    var cellht = mY/3; // max divided by 15, to get height/y of equal cell
    
    var occurrences = {};
    
    function PlotGaze(GazeData) {
        var x = GazeData.docX/cellwd; //value of x, with decimal
        var y = GazeData.docY/cellht; //value of y, with decimal
        finalx = (x > 0) ? Math.trunc(x+1)-1 : 0; //final array location cell[.][x]
        finaly = (y > 0) ? Math.trunc(y+1)-1 : 0; //final array location cell[y][.]
        
        if(caldone == 1) {
            //console.log("dox: " + Math.trunc(x) + " , doy: " + Math.trunc(y) + " , finalX: " + finalx + " , finalY: " + finaly + " | finalcell: cell[" + finaly + "][" + finalx + "]");
            var cellloc = finaly.toString() + "|" + finalx.toString();
			
            if (occurrences[cellloc] === undefined) {
                occurrences[cellloc] = 1;
            } else {
                occurrences[cellloc]++;
            }
        }
    
        var gaze = document.getElementById("gaze");
        gaze.style.left = GazeData.docX + "px";
        gaze.style.top = GazeData.docY + "px";
        
        if (GazeData.state != 0) {
            if (gaze.style.display == 'block')
                gaze.style.display = 'none';
        } else {
            if (gaze.style.display == 'none')
                gaze.style.display = 'block';
        }
    }
    
    //set callbacks
    window.addEventListener("load", function() {
        GazeCloudAPI.OnCalibrationComplete = function() {
            console.log('gaze Calibration Complete');
            caldone = 1;
			//now begin 10s timer to focus
			//add a 10s short instruction screen here which says to focus on chart for 10s
			
            setTimeout(function () {
                GazeCloudAPI.StopEyeTracking();
                caldone = 0;
                
                const finalcellloc = findMaxOccurrence(occurrences);
                var cellintable = document.getElementById(finalcellloc);
                cellintable.style.backgroundColor = '#27ae60';
                cellintable.style.color = 'white';
				var refnum = chosenarray.indexOf(cellintable.textContent);
                var tempi = finalcellloc.split('|')[0];
                var tempj = finalcellloc.split('|')[1];
				
                setTimeout(function () {
                    showResultPage(cellintable.textContent, tempi, tempj, refnum);
                }, 2000);
            }, 10000);
        }
        GazeCloudAPI.OnCamDenied = function() {
            alert('camera  access denied')
        }
        GazeCloudAPI.OnError = function(msg) {
            alert('err: ' + msg)
        }
        GazeCloudAPI.UseClickRecalibration = true;
        GazeCloudAPI.OnResult = PlotGaze;
    });
    
    //----------------------------------------------------------
	
	function shuffleArray(array) {
	  for (let i = array.length - 1; i > 0; i--) {
	    const j = Math.floor(Math.random() * (i + 1));
	    [array[i], array[j]] = [array[j], array[i]];
	  }
	}
	
    function generateMatrix() {
        const matrixTable = document.getElementById('matrix');
		let cellr = -1, cellc = -1;
		let randnum = Math.floor((Math.random()) * 13); //which array from 0-12 is to be chosen
		chosenarray = values2[randnum]; //above array original
		usagearray = chosenarray.slice(); //duplicate to be used for everyrthing
		shuffleArray(usagearray); //shuffle duplicate array for usage
		
		for (let i = 0; i < usagearray.length; i += 3) {
			let row = matrixTable.insertRow();
			cellr++;
			for (let j = i; j < i + 3; j++) {
				let cell = row.insertCell();
				cell.textContent = usagearray[j];
				cellc++;
				cell.id = cellr.toString() + "|" + cellc.toString();
				//console.log(cell.id);
			}
			cellc = -1;
		}
        setTimeout(function () {
            GazeCloudAPI.StartEyeTracking(); //start calibration process
        }, 1000);
    }

    function findMaxOccurrence(occurrences) {
        let maxString = null;
        let maxOccurrences = -1;
    
        for (const str in occurrences) {
            if (occurrences.hasOwnProperty(str)) {
                if (occurrences[str] > maxOccurrences) {
                    maxString = str;
                    maxOccurrences = occurrences[str];
                }
            }
        }
        return maxString;
    }

	function showMatrixPage() {
        document.getElementById('welcome-page').style.display = 'none';
		document.getElementById('webheader').style.display = 'none';
        document.getElementById('matrix-container').style.display = 'inline';
        generateMatrix();
    }

	function showResultPage(value, row, col, ref) {
        document.getElementById('matrix-container').style.display = 'none';
        document.getElementById('result-page').style.display = 'block';
		document.getElementById('webheader').style.display = 'flex';
        document.getElementById('result-value').textContent = value;
        
        document.getElementById("result2").style.fontWeight = 'bold';
        document.getElementById("result3").style.fontWeight = 'bold';

        //let descref = loc[row][col];
		let descref = ref; //direct final 0-8 value
        
        if(desc[descref][0] == 1) { //-ve outcome
          document.getElementById("result2").style.color = "#ff0000";
          document.getElementById("result3").style.color = "#ff0000";
          //document.getElementById("result-image").src = "cross.png";
        } else { //+ve outcome
          document.getElementById("result2").style.color = "#087809";
          document.getElementById("result3").style.color = "#087809";
          //document.getElementById("result-image").src = "check.png";
        }
        
        document.getElementById('result1').textContent = desc[descref][1];
        document.getElementById('result2').textContent = desc[descref][2];
        document.getElementById('result3').textContent = desc[descref][3];
        document.getElementById('result4').textContent = desc[descref][4];
        document.getElementById('result5').innerHTML = desc[descref][5][0] + "<br>" + desc[descref][5][1] + "<br>" + desc[descref][5][2] + "<br>" + desc[descref][5][3];
        document.getElementById('result6').textContent = desc[descref][6];
    	document.body.scrollTop = document.documentElement.scrollTop = 0;
    }

    // Function to restart
    function restartGame() {
        document.getElementById('result-page').style.display = 'none';
        document.getElementById('welcome-page').style.display = 'block';
		document.getElementById('webheader').style.display = 'flex';
		document.body.scrollTop = document.documentElement.scrollTop = 0;

        const matrixTable = document.getElementById('matrix');
        matrixTable.innerHTML = '';
        Object.keys(occurrences).forEach((prop) => {
			delete occurrences[prop];
        });
    }
    
    function showTab(tabName) {
      const tabs = ['hindi', 'english'];
      tabs.forEach(tab => {
        const tabContent = document.getElementById(tab + 'Content');
        const tabButton = document.querySelector(`.tab[data-tab="${tab}"]`);

        if (tab === tabName) {
          tabContent.classList.add('active');
          tabButton.classList.add('active');
        } else {
          tabContent.classList.remove('active');
          tabButton.classList.remove('active');
        }
      });
    }
</script>
</body>
</html>
